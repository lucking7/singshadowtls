# sb.sh 菜单文案优化总结

## 优化目标

使菜单选项更清晰易懂,明确区分不同 DNS 配置选项的用途和适用场景。

---

## 优化后的菜单文案

### 配置管理部分

```
配置管理
  7) 查看当前配置
  8) 端口设置
  9) 密码设置
  10) ShadowTLS 设置
  11) Shadowsocks 设置
  12) DNS 基础设置 (DNS 策略和服务器)
  13) 流媒体解锁设置 (单机优化 - 查看/清除)
  14) DNS 分流配置 (被解锁机 - 配置解锁 DNS)
  15) DNS 解锁服务器 (解锁机 - 部署 DNS 服务)
```

---

## 各选项功能说明

### 选项 12: DNS 基础设置

**菜单文案:**
```
DNS 基础设置 (DNS 策略和服务器)
```

**功能:**
- 管理 DNS 策略 (prefer_ipv4, prefer_ipv6, ipv4_only, ipv6_only)
- 更改 DNS 服务器 (Cloudflare, Google, AdGuard 等)

**适用场景:**
- 基础 DNS 配置
- 调整 DNS 解析策略
- 更换默认 DNS 服务器

**与其他选项的区别:**
- 这是**基础 DNS 配置**,不涉及流媒体解锁
- 选项 13-15 是**高级 DNS 解锁配置**

---

### 选项 13: 流媒体解锁设置

**菜单文案:**
```
流媒体解锁设置 (单机优化 - 查看/清除)
```

**功能:**
- 查看当前流媒体解锁配置
- 清除流媒体解锁配置 (FakeIP, DNS 规则等)

**适用场景:**
- 单机流媒体解锁优化
- 清理旧的解锁配置
- 调试和验证配置

**重要说明:**
```
此功能用于单机流媒体解锁优化
注意: 三层架构解锁方案请使用:
  • 被解锁机: 选项 14 (DNS 分流配置)
  • 解锁机: 选项 15 (DNS 解锁服务器)
```

---

### 选项 14: DNS 分流配置

**菜单文案:**
```
DNS 分流配置 (被解锁机 - 配置解锁 DNS)
```

**功能标题:**
```
DNS 分流配置 (被解锁机)
```

**功能说明:**
```
此功能用于被解锁机配置 DNS 分流规则
流媒体/AI 域名使用解锁机 DNS,其他域名使用公共 DNS
```

**适用场景:**
```
  • 被解锁机作为中转代理服务器
  • 需要将流媒体流量转发到解锁机
  • 解锁机已部署 SNI Proxy + DNS 服务器
```

**功能选项:**
```
  1) 配置 DNS 分流规则
  2) 查看当前 DNS 分流配置
  3) 恢复默认 DNS 配置
  0) 返回主菜单
```

---

### 选项 15: DNS 解锁服务器

**菜单文案:**
```
DNS 解锁服务器 (解锁机 - 部署 DNS 服务)
```

**功能标题:**
```
DNS 解锁服务器部署 (解锁机)
```

**功能说明:**
```
此功能用于在解锁机上部署 DNS 服务器
配合 SNI Proxy 实现流媒体解锁
```

**适用场景:**
```
  • 解锁机部署 DNS 服务器
  • 将流媒体域名解析到解锁机 IP
  • 配合 SNI Proxy 实现解锁
```

**前置要求:**
```
  • 已使用 install_sniproxy.sh 部署 SNI Proxy
  • SNI Proxy 监听 0.0.0.0:80/443
```

**功能选项:**
```
  1) 部署 DNS 解锁服务器
  2) 查看 DNS 服务器配置
  3) 测试 DNS 服务器
  4) 生成客户端配置说明
  0) 返回主菜单
```

---

## 文案设计原则

### 1. 清晰的层级关系

```
选项 12: DNS 基础设置
    ↓ (基础配置)
选项 13: 流媒体解锁设置 (单机)
    ↓ (高级配置 - 单机优化)
选项 14: DNS 分流配置 (被解锁机)
    ↓ (高级配置 - 三层架构)
选项 15: DNS 解锁服务器 (解锁机)
    ↓ (高级配置 - 三层架构)
```

---

### 2. 明确的角色标注

| 选项 | 角色标注 | 说明 |
|------|----------|------|
| 12 | 无 | 通用基础配置 |
| 13 | 单机优化 | 单机使用 |
| 14 | 被解锁机 | 三层架构中的中转服务器 |
| 15 | 解锁机 | 三层架构中的解锁服务器 |

---

### 3. 功能范围说明

| 选项 | 功能范围 | 括号说明 |
|------|----------|----------|
| 12 | DNS 策略和服务器 | (DNS 策略和服务器) |
| 13 | 查看/清除配置 | (单机优化 - 查看/清除) |
| 14 | 配置解锁 DNS | (被解锁机 - 配置解锁 DNS) |
| 15 | 部署 DNS 服务 | (解锁机 - 部署 DNS 服务) |

---

### 4. 使用场景引导

**选项 13 的引导:**
```
此功能用于单机流媒体解锁优化
注意: 三层架构解锁方案请使用:
  • 被解锁机: 选项 14 (DNS 分流配置)
  • 解锁机: 选项 15 (DNS 解锁服务器)
```

**选项 14 的引导:**
```
适用场景:
  • 被解锁机作为中转代理服务器
  • 需要将流媒体流量转发到解锁机
  • 解锁机已部署 SNI Proxy + DNS 服务器
```

**选项 15 的引导:**
```
前置要求:
  • 已使用 install_sniproxy.sh 部署 SNI Proxy
  • SNI Proxy 监听 0.0.0.0:80/443
```

---

## 用户决策流程

### 场景 1: 基础 DNS 配置

```
用户需求: 更改 DNS 服务器或调整 DNS 策略
    ↓
选择: 选项 12 (DNS 基础设置)
    ↓
操作: 管理 DNS 策略或更改 DNS 服务器
```

---

### 场景 2: 单机流媒体解锁

```
用户需求: 在单台服务器上实现流媒体解锁
    ↓
选择: 选项 13 (流媒体解锁设置)
    ↓
操作: 查看或清除流媒体解锁配置
    ↓
注意: 看到提示 "三层架构请使用选项 14 和 15"
```

---

### 场景 3: 三层架构解锁 (被解锁机)

```
用户需求: 配置被解锁机的 DNS 分流
    ↓
选择: 选项 14 (DNS 分流配置)
    ↓
确认: 看到 "被解锁机" 标注
    ↓
操作: 配置 DNS 分流规则
    ↓
配置: 流媒体 → 解锁机 DNS, 其他 → Cloudflare DNS
```

---

### 场景 4: 三层架构解锁 (解锁机)

```
用户需求: 在解锁机上部署 DNS 服务器
    ↓
选择: 选项 15 (DNS 解锁服务器)
    ↓
确认: 看到 "解锁机" 标注和前置要求
    ↓
检查: 是否已部署 SNI Proxy
    ↓
操作: 部署 DNS 解锁服务器
```

---

## 文案对比

### 优化前

```
12) DNS 设置
13) 流媒体解锁设置 (类似 SNI Proxy + smartdns)
14) DNS 分流配置 (按平台配置不同 DNS)
15) 纯 DNS 解锁服务器 (不代理流量)
```

**问题:**
- 选项 12 和 13-15 的区别不明确
- "类似 SNI Proxy + smartdns" 容易误导用户
- "按平台配置不同 DNS" 不够清晰
- "不代理流量" 容易让人误解功能

---

### 优化后

```
12) DNS 基础设置 (DNS 策略和服务器)
13) 流媒体解锁设置 (单机优化 - 查看/清除)
14) DNS 分流配置 (被解锁机 - 配置解锁 DNS)
15) DNS 解锁服务器 (解锁机 - 部署 DNS 服务)
```

**改进:**
- ✅ 明确区分基础配置和高级配置
- ✅ 清晰标注单机和三层架构的区别
- ✅ 明确标注被解锁机和解锁机的角色
- ✅ 准确描述功能范围 (查看/清除, 配置, 部署)

---

## 文案一致性

### 主菜单文案

| 选项 | 主菜单文案 |
|------|-----------|
| 12 | DNS 基础设置 **(DNS 策略和服务器)** |
| 13 | 流媒体解锁设置 **(单机优化 - 查看/清除)** |
| 14 | DNS 分流配置 **(被解锁机 - 配置解锁 DNS)** |
| 15 | DNS 解锁服务器 **(解锁机 - 部署 DNS 服务)** |

---

### 功能页面标题

| 选项 | 功能页面标题 |
|------|-------------|
| 12 | DNS 设置 |
| 13 | 流媒体解锁配置 **(单机优化)** |
| 14 | DNS 分流配置 **(被解锁机)** |
| 15 | DNS 解锁服务器部署 **(解锁机)** |

---

### 注释文案

| 选项 | 函数注释 |
|------|----------|
| 12 | Function to display DNS submenu |
| 13 | Function to configure streaming media unlock **(单机优化 - 查看/清除配置)** |
| 14 | Function to configure DNS routing **(被解锁机 - 配置解锁 DNS)** |
| 15 | Function to configure DNS unlock server **(解锁机 - 部署 DNS 服务)** |

---

## 总结

### 优化要点

1. **清晰的层级关系** - 基础配置 vs 高级配置
2. **明确的角色标注** - 单机 vs 被解锁机 vs 解锁机
3. **准确的功能描述** - 查看/清除 vs 配置 vs 部署
4. **有效的场景引导** - 适用场景和前置要求说明

---

### 用户体验改进

- ✅ 用户可以快速识别需要使用的选项
- ✅ 避免混淆基础配置和高级配置
- ✅ 明确三层架构中的角色分工
- ✅ 提供清晰的使用引导

---

### 技术准确性

- ✅ 准确反映功能实现
- ✅ 符合三层架构设计
- ✅ 与代码实现一致
- ✅ 避免技术误导

---

## 后续建议

### 1. 国际化支持

考虑为选项 12 的子菜单添加中文翻译:

**当前:**
```
1) Manage DNS Strategies
2) Change DNS Servers
0) Back to Main Menu
```

**建议:**
```
1) 管理 DNS 策略
2) 更改 DNS 服务器
0) 返回主菜单
```

---

### 2. 帮助文档链接

在每个选项的功能页面添加帮助文档链接:

```
需要帮助? 查看文档:
  • 三层架构快速配置指南.md
  • 脚本优化说明.md
  • DNS解锁教程.md
```

---

### 3. 配置向导

为新用户提供交互式配置向导:

```
检测到首次使用 DNS 解锁功能
是否启动配置向导? [Y/n]

配置向导将帮助你:
  1. 识别服务器角色 (解锁机/被解锁机)
  2. 选择合适的配置选项
  3. 完成必要的配置步骤
```

---

### 4. 配置验证

添加配置验证功能:

```
配置完成后自动验证:
  ✓ DNS 服务器监听状态
  ✓ DNS 解析结果
  ✓ 路由规则配置
  ✓ 服务运行状态
```

---

**菜单文案优化已完成!** 🎉

